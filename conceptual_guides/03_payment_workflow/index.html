
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://aitw.github.io/qapi-docs/conceptual_guides/03_payment_workflow/">
      
      
        <link rel="prev" href="../02_conceptual_architecture/">
      
      
        <link rel="next" href="../../04_compliance_security/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Payment Workflows - QBank Connect API Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/css/custom.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#payment-workflows-integrity-and-webhooks" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="QBank Connect API Documentation" class="md-header__button md-logo" aria-label="QBank Connect API Documentation" data-md-component="logo">
      
  <img src="../../assets/images/q_icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            QBank Connect API Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Payment Workflows
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/aiTechnicalWriter/qapi-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    qapi-docs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="QBank Connect API Documentation" class="md-nav__button md-logo" aria-label="QBank Connect API Documentation" data-md-component="logo">
      
  <img src="../../assets/images/q_icon.png" alt="logo">

    </a>
    QBank Connect API Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aiTechnicalWriter/qapi-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    qapi-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01_getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Conceptual Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Conceptual Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02_conceptual_architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Payment Workflows
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Payment Workflows
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-transactional-idempotency-protocol" class="md-nav__link">
    <span class="md-ellipsis">
      1. Transactional Idempotency Protocol
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Transactional Idempotency Protocol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-header-requirement" class="md-nav__link">
    <span class="md-ellipsis">
      1.1. Header Requirement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-conflict-resolution-http-409" class="md-nav__link">
    <span class="md-ellipsis">
      1.2. Conflict Resolution (HTTP 409)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-payment-orchestration-state-machine" class="md-nav__link">
    <span class="md-ellipsis">
      2. Payment Orchestration State Machine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-payable-confirmation-webhooks" class="md-nav__link">
    <span class="md-ellipsis">
      3. Payable Confirmation Webhooks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Payable Confirmation Webhooks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-webhook-event" class="md-nav__link">
    <span class="md-ellipsis">
      3.1. Webhook Event
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-security-mandate-signature-verification" class="md-nav__link">
    <span class="md-ellipsis">
      3.2. Security Mandate: Signature Verification
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04_compliance_security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Compliance & Security
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05_api_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    SDK Integration
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            SDK Integration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sdk_integration/sdk_python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python SDK
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sdk_integration/sdk_typescript/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TypeScript SDK
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../06_glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-transactional-idempotency-protocol" class="md-nav__link">
    <span class="md-ellipsis">
      1. Transactional Idempotency Protocol
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Transactional Idempotency Protocol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-header-requirement" class="md-nav__link">
    <span class="md-ellipsis">
      1.1. Header Requirement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-conflict-resolution-http-409" class="md-nav__link">
    <span class="md-ellipsis">
      1.2. Conflict Resolution (HTTP 409)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-payment-orchestration-state-machine" class="md-nav__link">
    <span class="md-ellipsis">
      2. Payment Orchestration State Machine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-payable-confirmation-webhooks" class="md-nav__link">
    <span class="md-ellipsis">
      3. Payable Confirmation Webhooks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Payable Confirmation Webhooks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-webhook-event" class="md-nav__link">
    <span class="md-ellipsis">
      3.1. Webhook Event
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-security-mandate-signature-verification" class="md-nav__link">
    <span class="md-ellipsis">
      3.2. Security Mandate: Signature Verification
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="payment-workflows-integrity-and-webhooks">Payment Workflows: Integrity and Webhooks</h1>
<p>This guide covers the non-negotiable requirements for submitting financial transactions, ensuring <strong>exactly-once execution</strong> and tracking payment status via our finite state machine.<sup id="fnref:16"><a class="footnote-ref" href="#fn:16">1</a></sup></p>
<h2 id="1-transactional-idempotency-protocol">1. Transactional Idempotency Protocol</h2>
<p>For all mutable operations (<code>POST</code>, <code>PUT</code>, <code>PATCH</code>), the <strong><code>Idempotency-Key</code></strong> header is mandatory. This protects your system from network failures, allowing safe request retries without creating duplicate payments.<sup id="fnref:17"><a class="footnote-ref" href="#fn:17">2</a></sup><sup id="fnref:18"><a class="footnote-ref" href="#fn:18">3</a></sup></p>
<h3 id="11-header-requirement">1.1. Header Requirement</h3>
<table>
<thead>
<tr>
<th style="text-align: left;">Header</th>
<th style="text-align: left;">Value Format</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>Idempotency-Key</code></td>
<td style="text-align: left;">UUID v4 (36 characters)</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">Ensures exactly-once execution, acting as a unique database constraint.<sup id="fnref2:17"><a class="footnote-ref" href="#fn:17">2</a></sup></td>
</tr>
</tbody>
</table>
<h3 id="12-conflict-resolution-http-409">1.2. Conflict Resolution (HTTP 409)</h3>
<p>If you submit a payment request, but the network connection times out, your system may automatically retry. If the first request was received and is currently being processed by the mETL engine, the API will reject the retry attempt with a <code>409 Conflict</code>.</p>
<p><strong>Client Action:</strong> When receiving a <code>409 Conflict</code>, <strong>DO NOT</strong> retry the submission immediately. Instead, use the related status endpoint (<code>GET /payments/{id}</code>) to check the status of the original request.<sup id="fnref2:16"><a class="footnote-ref" href="#fn:16">1</a></sup></p>
<p><strong>Mandatory 409 Response Structure</strong></p>
<p>The response body adheres to the standardized <code>application/problem+json</code> format:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="err">HTTP/</span><span class="mf">1.1</span><span class="w"> </span><span class="mi">409</span><span class="w"> </span><span class="err">Co</span><span class="kc">nfl</span><span class="err">ic</span><span class="kc">t</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="err">Li</span><span class="kc">n</span><span class="err">k</span><span class="p">:</span><span class="w"> </span><span class="err">h</span><span class="kc">tt</span><span class="err">ps</span><span class="p">:</span><span class="c1">//docs.qbankconnect.com/03_payment_workflow.md#transactional-idempotency-protocol; rel=&quot;describedby&quot;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="err">Co</span><span class="kc">ntent</span><span class="mi">-</span><span class="err">Type</span><span class="p">:</span><span class="w"> </span><span class="err">applica</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="err">/problem+jso</span><span class="kc">n</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">{</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://api.qbankconnect.com/errors/idempotency_conflict&quot;</span><span class="p">,</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A request is outstanding for this Idempotency-Key&quot;</span><span class="p">,</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">409</span><span class="p">,</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="nt">&quot;detail&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;The payment submission with this key is already in the P_VALIDATED or P_SUBMITTED_TO_CORE state.&quot;</span><span class="p">,</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="nt">&quot;instance&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;a2b3c4d5-6e7f-8g9h-0i1j-2k3l4m5n6o7p&quot;</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="p">}</span>
</span></code></pre></div>
<h2 id="2-payment-orchestration-state-machine">2. Payment Orchestration State Machine</h2>
<p>All asynchronous payment requests (ACH, Positive Pay issues) are tracked by the Payment Orchestration Service (POS) through a defined finite-state machine. <sup id="fnref:19"><a class="footnote-ref" href="#fn:19">4</a></sup> <sup id="fnref:20"><a class="footnote-ref" href="#fn:20">5</a></sup></p>
<table>
<thead>
<tr>
<th style="text-align: left;">State</th>
<th style="text-align: left;">Transition Event</th>
<th style="text-align: left;">Actor/System</th>
<th style="text-align: left;">Latency</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong><code>P_CREATED</code></strong></td>
<td style="text-align: left;"><code>POST /payments/ach</code> is received.</td>
<td style="text-align: left;">ERP Platform / API</td>
<td style="text-align: left;">Instant</td>
</tr>
<tr>
<td style="text-align: left;"><strong><code>P_VALIDATED</code></strong></td>
<td style="text-align: left;">Input validation (schema, funds check) succeeds.</td>
<td style="text-align: left;">QBank Connect Service</td>
<td style="text-align: left;">Sub-second</td>
</tr>
<tr>
<td style="text-align: left;"><strong><code>P_SUBMITTED_TO_CORE</code></strong></td>
<td style="text-align: left;"><strong>mETL Job</strong> successfully places the batch file in the Fiserv SFTP location.</td>
<td style="text-align: left;">mETL Engine</td>
<td style="text-align: left;">15 minutes (Max)</td>
</tr>
<tr>
<td style="text-align: left;"><strong><code>P_PROCESSING</code></strong></td>
<td style="text-align: left;">Fiserv CoreAdvance acknowledges receipt and begins processing.</td>
<td style="text-align: left;">Fiserv CoreAdvance</td>
<td style="text-align: left;">Variable (EOD)</td>
</tr>
<tr>
<td style="text-align: left;"><strong><code>P_COMPLETED</code></strong></td>
<td style="text-align: left;">Final settlement confirmation received.</td>
<td style="text-align: left;">mETL / POS</td>
<td style="text-align: left;">Next Business Day</td>
</tr>
<tr>
<td style="text-align: left;"><strong><code>P_FAILED</code></strong></td>
<td style="text-align: left;">Core Rejection or validation failure.</td>
<td style="text-align: left;">CoreAdvance / POS</td>
<td style="text-align: left;">Immediate or Batch</td>
</tr>
</tbody>
</table>
<h2 id="3-payable-confirmation-webhooks">3. Payable Confirmation Webhooks</h2>
<p>For time-sensitive payables, QBank Connect provides guaranteed delivery of status updates via webhooks. <sup id="fnref3:16"><a class="footnote-ref" href="#fn:16">1</a></sup></p>
<h3 id="31-webhook-event">3.1. Webhook Event</h3>
<p>When a key state transition occurs (e.g., from <code>P_PROCESSING</code> to <code>P_COMPLETED</code>), the <strong>Webhook Notification Service (WNS)</strong> sends an event payload to your registered callback URL.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Header</th>
<th style="text-align: left;">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>Webhook-Event-ID</code></td>
<td style="text-align: left;">Unique identifier for this webhook delivery attempt.</td>
</tr>
<tr>
<td style="text-align: left;"><code>Webhook-Signature</code></td>
<td style="text-align: left;">HMAC signature used to verify the payload's origin and integrity.</td>
</tr>
</tbody>
</table>
<h3 id="32-security-mandate-signature-verification">3.2. Security Mandate: Signature Verification</h3>
<p>To prevent spoofing and ensure non-repudiation, you <strong>must</strong> verify the <code>Webhook-Signature</code> header against the payload using your QBank-provided shared secret. <strong>Events received without a valid signature must be discarded</strong>.</p>
<h2 id="references">References</h2>
<div class="footnote">
<hr />
<ol>
<li id="fn:16">
<p>QBank Connect API Reference, "Payment Status and Webhook Integration."&#160;<a class="footnote-backref" href="#fnref:16" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:16" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref3:16" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:17">
<p>Idempotency Key Specification, RFC 8142 (Conceptual Reference).&#160;<a class="footnote-backref" href="#fnref:17" title="Jump back to footnote 2 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:17" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:18">
<p>Payments API Integration Guide, "Handling Duplicate Submissions."&#160;<a class="footnote-backref" href="#fnref:18" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:19">
<p>Payment Orchestration Service (POS) State Diagram, Internal Document.&#160;<a class="footnote-backref" href="#fnref:19" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:20">
<p>Fiserv CoreAdvance Batch Processing Guide, "Payment Lifecycle States."&#160;<a class="footnote-backref" href="#fnref:20" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
</ol>
</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.instant.prefetch", "content.code.annotate", "content.code.copy", "navigation.expand", "content.tabs.link", "content.diagrams"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>